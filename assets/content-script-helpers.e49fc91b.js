import{c as K,a as V}from"./jquery.050764e9.js";var j={exports:{}};(function(r){(function(t){var i=/^[a-z]+:/,n=/[-a-z0-9]+(\.[-a-z0-9])*:\d+/i,l=/\/\/(.*?)(?::(.*?))?@/,u=/^win/i,y=/:$/,c=/^\?/,d=/^#/,q=/(.*\/)/,x=/^\/{2,}/,S=/(^\/?)/,w=/'/g,g=/%([ef][0-9a-f])%([89ab][0-9a-f])%([89ab][0-9a-f])/gi,L=/%([cd][0-9a-f])%([89ab][0-9a-f])/gi,R=/%([0-7][0-9a-f])/gi,O=/\+/g,Q=/^\w:$/,H=/[^/#?]/,P,b=typeof window=="undefined"&&typeof K!="undefined"&&typeof V=="function",B=!b&&t.navigator&&t.navigator.userAgent&&~t.navigator.userAgent.indexOf("MSIE"),z=b?t.require:null,F={protocol:"protocol",host:"hostname",port:"port",path:"pathname",query:"search",hash:"hash"},G={ftp:21,gopher:70,http:80,https:443,ws:80,wss:443};function U(){return b?P=P||"file://"+(process.platform.match(u)?"/":"")+z("fs").realpathSync("."):document.location.href==="about:srcdoc"?self.parent.document.location.href:document.location.href}function N(e,o,h){var s,a,f;o=o||U(),b?s=z("url").parse(o):(s=document.createElement("a")).href=o;var p,v,I=(v={path:!0,query:!0,hash:!0},(p=o)&&i.test(p)&&(v.protocol=!0,v.host=!0,n.test(p)&&(v.port=!0),l.test(p)&&(v.user=!0,v.pass=!0)),v);for(a in f=o.match(l)||[],F)I[a]?e[a]=s[F[a]]||"":e[a]="";if(e.protocol=e.protocol.replace(y,""),e.query=e.query.replace(c,""),e.hash=A(e.hash.replace(d,"")),e.user=A(f[1]||""),e.pass=A(f[2]||""),e.port=G[e.protocol]==e.port||e.port==0?"":e.port,!I.protocol&&H.test(o.charAt(0))&&(e.path=o.split("?")[0].split("#")[0]),!I.protocol&&h){var E=new m(U().match(q)[0]),C=E.path.split("/"),k=e.path.split("/"),D=["protocol","user","pass","host","port"],J=D.length;for(C.pop(),a=0;a<J;a++)e[D[a]]=E[D[a]];for(;k[0]==="..";)C.pop(),k.shift();e.path=(o.charAt(0)!=="/"?C.join("/"):"")+"/"+k.join("/")}e.path=e.path.replace(x,"/"),B&&(e.path=e.path.replace(S,"/")),e.paths(e.paths()),e.query=new T(e.query)}function M(e){return encodeURIComponent(e).replace(w,"%27")}function A(e){return(e=(e=(e=e.replace(O," ")).replace(g,function(o,h,s,a){var f=parseInt(h,16)-224,p=parseInt(s,16)-128;if(f==0&&p<32)return o;var v=(f<<12)+(p<<6)+(parseInt(a,16)-128);return 65535<v?o:String.fromCharCode(v)})).replace(L,function(o,h,s){var a=parseInt(h,16)-192;if(a<2)return o;var f=parseInt(s,16)-128;return String.fromCharCode((a<<6)+f)})).replace(R,function(o,h){return String.fromCharCode(parseInt(h,16))})}function T(e){for(var o=e.split("&"),h=0,s=o.length;h<s;h++){var a=o[h].split("="),f=decodeURIComponent(a[0].replace(O," "));if(f){var p=a[1]!==void 0?A(a[1]):null;this[f]===void 0?this[f]=p:(this[f]instanceof Array||(this[f]=[this[f]]),this[f].push(p))}}}function m(e,o){N(this,e,!o)}T.prototype.toString=function(){var e,o,h="",s=M;for(e in this){var a=this[e];if(!(a instanceof Function||a===void 0))if(a instanceof Array){var f=a.length;if(!f){h+=(h?"&":"")+s(e)+"=";continue}for(o=0;o<f;o++){var p=a[o];p!==void 0&&(h+=h?"&":"",h+=s(e)+(p===null?"":"="+s(p)))}}else h+=h?"&":"",h+=s(e)+(a===null?"":"="+s(a))}return h},m.prototype.clearQuery=function(){for(var e in this.query)this.query[e]instanceof Function||delete this.query[e];return this},m.prototype.queryLength=function(){var e=0;for(var o in this.query)this.query[o]instanceof Function||e++;return e},m.prototype.isEmptyQuery=function(){return this.queryLength()===0},m.prototype.paths=function(e){var o,h="",s=0;if(e&&e.length&&e+""!==e){for(this.isAbsolute()&&(h="/"),o=e.length;s<o;s++)e[s]=!s&&Q.test(e[s])?e[s]:M(e[s]);this.path=h+e.join("/")}for(s=0,o=(e=(this.path.charAt(0)==="/"?this.path.slice(1):this.path).split("/")).length;s<o;s++)e[s]=A(e[s]);return e},m.prototype.encode=M,m.prototype.decode=A,m.prototype.isAbsolute=function(){return this.protocol||this.path.charAt(0)==="/"},m.prototype.toString=function(){return(this.protocol&&this.protocol+"://")+(this.user&&M(this.user)+(this.pass&&":"+M(this.pass))+"@")+(this.host&&this.host)+(this.port&&":"+this.port)+(this.path&&this.path)+(this.query.toString()&&"?"+this.query)+(this.hash&&"#"+M(this.hash))},t[t.exports?"exports":"Url"]=m})(r.exports?r:window)})(j);var X=j.exports,Y={methods:{shortenLength:function(r){if(r)if(r=DOMPurify.sanitize(r.trimToColon().trimAll()),r.match(/\d/)){const t=this.timeStringToSeconds(r);return this.secondsToTimeString(t,!0)}else return null;else return null},getSummary:function(r){r.removeAttribute("class");var t=r.querySelectorAll("*");return $.each(t,function(){this.removeAttribute("class")}),DOMPurify.sanitize(r.outerHTML.trimAll())},fixDates:function(r){var t=typeof r=="object"?DOMPurify.sanitize(r.textContent.trimToColon()):DOMPurify.sanitize(r);if(r&&t){const i=this.domainExtension,n={".com":["m-d-y","MM-dd-yyyy"],".ca":["y-m-d","yyyy-MM-dd"],".co.uk":["d-m-y","dd-MM-yyyy"],".de":["d-m-y","dd-MM-yyyy"],".fr":["d-m-y","dd-MM-yyyy"],".it":["d-m-y","dd-MM-yyyy"],".com.au":["d-m-y","dd-MM-yyyy"],".in":["d-m-y","dd-MM-yyyy"]},l=n[i]?n[i][0]:null;let u=t.split("-");if(!l||!t.match(/\-/)||u.length!==3)return t;{const y=l.split("-"),c={y:null,m:null,d:null};$.each(u,function(q,x){c[y[q]]=x}),t=null,c.y.length<=2&&(c.y>=95&&c.y<=99?c.y="19"+c.y:c.y<95&&(c.y="20"+c.y));const d=[c.y,c.m,c.d];return dateFormat(new Date(d[0],d[1]-1,d[2]),"yyyy-MM-dd")}}else return null},getSeries:function(r,t){const i=[];if(r){var n=DOMPurify.sanitize($(r).html()).trimAll().trimToColon();n=$.parseHTML(n);const u=_.filter(n,function(y){var c=y.textContent.trim().replace(/^,/,"")||"";if(c)return y});$.each(u,function(y,c){var d=c.textContent.trim().replace(/^,/,"").trimAll()||"",q=(y+1)%2,x=!q;if(q){let g=new Url(c.href);i.push({name:d,asin:t?g.query.asin:g.path.substring(g.path.lastIndexOf("/")+1)})}else if(x&&d.match(/\d/)){var S=d.replace(/^[^0-9]*/,"").replace(/,$/,"").replace(/;$/,"").trim().split(","),w=i[i.length-1];w.bookNumbers=$.map(S,function(g){return""+g})}})}return i.length>0?t?i.reverse():i:null},getArray:function(r){const t=[];return $(r).each(function(){const n=new Url(DOMPurify.sanitize($(this).attr("href")),!0);let l,u,y;n.query.searchAuthor&&(l=n.query.searchAuthor),n.query.searchNarrator&&(u=n.query.searchNarrator),n.query.searchProvider&&(y=n.query.searchProvider),n.clearQuery(),l&&(n.query.searchAuthor=l),u&&(n.query.searchNarrator=u),y&&(n.query.searchProvider=y),u=null,y=null;let c={name:DOMPurify.sanitize($(this).text().trim())};const d=i(n.toString());d&&(c.url=d),t.push(c)}),t.length>0?t:null;function i(n){return n.match(/^\/cat\//)||n.match(/^\/author\//)?n.substring(n.lastIndexOf("/")+1):n.match(/^\/search\?searchAuthor/)||n.match(/^\/search\?searchNarrator/)||n.match(/^\/search\?searchProvider/)?null:n}},addedOrder:function(r){let t=r.length+1;_.each(r,function(i){--t,i.added=t})},makeFrenchFries:function(r){r.extras=r.extras||{},r.extras["domain-extension"]=r.extras["domain-extension"]||this.domainExtension,r.chunks=[],_.each(r,function(t,i){if(i!=="chunks"&&_.isArray(t)){const n=_.chunk(t,50);r.chunks.push(i),r[i+"-chunk-length"]=n.length,_.each(n,function(l,u){r[i+"-chunk-"+u]=l}),delete r[i]}})},glueFriesBackTogether:function(r){if(r&&_.isEmpty(r))return null;_.each(r.chunks,function(t){const i=r[t+"-chunk-length"],n=_.range(0,i);r[t]=[],_.each(n,function(l){r[t]=r[t].concat(r[t+"-chunk-"+l]),delete r[t+"-chunk-"+l]}),delete r[t+"-chunk-length"]}),delete r.chunks},removeFromSeries:function(r,t){_.each(t,function(i){i.series&&_.each(i.series,function(n){let l=_.find(r,{asin:n.asin});_.remove(l.books,function(u){return u===i.asin}),l.books.length<1&&_.remove(r,function(u){return u.asin===n.asin})})})},removeFromCollections:function(r,t){r=_.compact(r),_.each(r,function(i){i.books.length>0&&_.each(t,function(n){_.includes(i.books,n.asin)&&_.remove(i.books,function(u){return u===n.asin}),i.books.length<1&&_.remove(r,function(u){return u.id===i.id})})})}}};export{X as U,Y as h};
